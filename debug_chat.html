<!DOCTYPE html>
<html>
<head>
    <title>Debug Chat</title>
</head>
<body>
    <div id="chat-messages"></div>
    
    <script>
        let messageIdCounter = 0;
        
        function escapeHtml(text) {
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }
        
        function formatAnswer(answer) {
            return answer;
        }
        
        function addMessage(type, content) {
            console.log('Adding message:', type, content);
            const messageId = 'message-' + (++messageIdCounter);
            const messageDiv = document.createElement('div');
            messageDiv.className = 'message';
            messageDiv.id = messageId;

            if (type === 'user') {
                messageDiv.classList.add('user-message');
                messageDiv.innerHTML = `
                    <div class="message-avatar">ðŸ‘¤</div>
                    <div class="message-content">
                        <p>${escapeHtml(content)}</p>
                        <div class="message-time">${new Date().toLocaleTimeString()}</div>
                    </div>
                `;
            } else if (type === 'assistant') {
                messageDiv.classList.add('assistant-message');
                messageDiv.innerHTML = `
                    <div class="message-avatar">ðŸ¤–</div>
                    <div class="message-content">
                        ${formatAnswer(content)}
                        <div class="message-time">${new Date().toLocaleTimeString()}</div>
                    </div>
                `;
            }
            
            document.getElementById('chat-messages').appendChild(messageDiv);
        }
        
        // Test the functions
        try {
            addMessage('user', 'Hello world');
            addMessage('assistant', 'Response');
            console.log('All functions work correctly');
        } catch (error) {
            console.error('Error:', error);
            document.body.innerHTML = '<div style="color: red;">Error: ' + error.message + '</div>';
        }
    </script>
</body>
</html>